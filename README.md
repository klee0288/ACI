**Project is not ready, avoid opening issues**

# ML-IDS

Applying machine learning principles to the information security field through intelligent intrusion detection systems.

This is a three phases project that can roughly described as

- Dataset
- Model Developement
- Advesarial Machine Learning

## Dataset

* **General Dataset Information**
  * Used the CSE-CIC 2018 which was made by using CIC-FlowMeter V2 which tracked the features of IP packets throughout the day while there was generic and malicous traffic flow
  * 81 Features were tracked total
  * 10 different days, with one attack per day
  * Seven different attacks: DDoS, Brute Force, SQL Injection, DoS, Botnet (Bot), Infiltration
  * Total of 16 million+ rows when merging all days into one big dataset
* Features
* **Preprocessing**
  * Cut down data from 81 to 31 features because of irrelevance of some features, inability to preprocess, and because those features did not affect the accuracy of the models
    * Utilized research of features and heatmap to determine which features were important
  * Merged all days into one big dataset and ran models based off that
  * Standarized all rows to ensure no outliers could affect the results and because each features had different statistical ranges which could potentially affect model results

<!--td {border: 1px solid #ccc;}br {mso-data-placement:same-cell;}-->| Feature           | Description                                                                                      | Categorical          | Range                                                                                                                                                                                                                                                     | Definition                                                                                                                                                                                                                                                                                                                                                                          |

| ------------------- | -------------------------------------------------------------------------------------------------- | ---------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Label             | Attack Name                                                                                      | Categorical          | FTP-BruteForce `<br/>`SSH-Bruteforce `<br/>`DoS-GoldenEye `<br/>`DoS-Slowloris `<br/>`DoS-SlowHTTPTest `<br/>`DoS-Hulk `<br/>`DDoS attacks `<br/>`LOIC-HTTP `<br/>`DDOS-LOIC-UDP `<br/>`DDOS-HOIC `<br/>`Brute Force -Web `<br/>`DDoS-LOIC-UDP `<br/>`DDoS attacks-LOIC-HTTP `<br/>`Brute Force -Web `<br/>`Brute Force -XSS `<br/>`SQL Injection `<br/>`Infiltration `<br/>`Bot |                                                                                                                                                                                                                                                                                                                                                                                     |
| Dst Port          | Destination Port                                                                                 | Number               | 0 ~ 65535                                                                                                                                                                                                                                                 | Destination Port are server aplications. Port 80 (HTTP), 443 (HTTPS) packets are directed to and processed by a Web server. User "registered ports" (1024-49151) are assigned to applications that are mostly vendor specific such as Skype and BitTorrent. 49152-65535 are private ports also called "dynamic ports"                                                               |
| Protocol          | Protocol                                                                                         | Categorical          | {0 ,6,7}                                                                                                                                                                                                                                                  | Single byte in the third word of a datagram header. Vaule idnetifies the protocl in layer above IP to which data hsould be apassed. On Unix, protocl numbers are defined /etc/protocols.                                                                                                                                                                                            |
| Timestamp         | What time                                                                                        | Number               | 02/14/2018 -> 03/02/2018                                                                                                                                                                                                                                  | Time of Incident                                                                                                                                                                                                                                                                                                                                                                    |
| Flow Duration     | Flow duration                                                                                    | Number (Microsecond) | 0 ~ 120000000                                                                                                                                                                                                                                             | Sequence of packets from a source computer to a destination                                                                                                                                                                                                                                                                                                                         |
| Tot Fwd Pkts      | Total size of packet in forward direction                                                        | Number               | 1 ~ 9021                                                                                                                                                                                                                                                  | Packet size affect performance of network a lot. A larger packet will take long time to transfer resulting into more collisions at layer 1. There is restriction affecting the rate of data transfer over the physical lines which means others won't get chance to use transmission line. It has an MTU (Maximum transmission Unit) which means it iwll be dropped if its too big. |
| Tot Bwd Pkts      | Total packets in the backward direction                                                          | Number               | 0 ~ 19181                                                                                                                                                                                                                                                 | Packet size affect performance of network a lot. A larger packet will take long time to transfer resulting into more collisions at layer 1. There is restriction affecting the rate of data transfer over the physical lines which means others won't get chance to use transmission line. It has an MTU (Maximum transmission Unit) which means it iwll be dropped if its too big. |
| TotLen Fwd Pkts   | Total size of packet in forward direction                                                        | Number               | 0 ~ 8737314                                                                                                                                                                                                                                               | Total Length of forward packets                                                                                                                                                                                                                                                                                                                                                     |
| TotLen Bwd Pkts   | Total Size of packet in backward direction                                                       | Number               | 0 ~ 27905234                                                                                                                                                                                                                                              | Total length of backward packets                                                                                                                                                                                                                                                                                                                                                    |
| Fwd Pkt Len Max   | Maximum size of packet in forward direction                                                      | Number               | 0~ 64440                                                                                                                                                                                                                                                  | Foward packet length max                                                                                                                                                                                                                                                                                                                                                            |
| Fwd Pkt Len Min   | Minimum size of packet in forward direction                                                      | Number               | 0~ 1460                                                                                                                                                                                                                                                   | Foward packet length min                                                                                                                                                                                                                                                                                                                                                            |
| Fwd Pkt Len Mean  | Average size of packet in forward direction                                                      | Number - Decimal     | 0.0~ 16529.3138401559                                                                                                                                                                                                                                     | Foward packet length average                                                                                                                                                                                                                                                                                                                                                        |
| Fwd Pkt Len Std   | Standard deviation size of packet in forward direction                                           | Number - Decimal     | 0.0~ 18401.5827717299                                                                                                                                                                                                                                     | Foward packet length standard deviation                                                                                                                                                                                                                                                                                                                                             |
| Bwd Pkt Len Max   | Maximum size of packet in backward direction                                                     | Number               | 0~ 2708                                                                                                                                                                                                                                                   | Maximum size of packet in forward direction                                                                                                                                                                                                                                                                                                                                         |
| Bwd Pkt Len Min   | Minimum size of packet in backward direction                                                     | Number               | 0~ 1176                                                                                                                                                                                                                                                   | packet length going backward direction                                                                                                                                                                                                                                                                                                                                              |
| Bwd Pkt Len Mean  | Mean size of packet in backward direction                                                        | Number - Decimal     | 0.0~ 1457.9413333332998                                                                                                                                                                                                                                   | packet length going backward direction                                                                                                                                                                                                                                                                                                                                              |
| Bwd Pkt Len Std   | Standard deviation size of packet in backward direction                                          | Number               | 0.0~ 1329.3607486307                                                                                                                                                                                                                                      | packet length going backward direction                                                                                                                                                                                                                                                                                                                                              |
| Flow Byts/s       | flow byte rate that is number of packets transferred per second                                  | Number               | 0.0 ~ inf                                                                                                                                                                                                                                                 | flow bytes per second                                                                                                                                                                                                                                                                                                                                                               |
| Flow Pkts/s       | flow packets rate that is number of packets transferred per second                               | Number - Decimal     | 0.016667843999999998~ inf                                                                                                                                                                                                                                 | flow packets per second                                                                                                                                                                                                                                                                                                                                                             |
| Flow IAT Mean     | Average time between two flows                                                                   | Number               | 0.0~ 119991524.0                                                                                                                                                                                                                                          | Packets flow inter arrival time Mean                                                                                                                                                                                                                                                                                                                                                |
| Flow IAT Std      | Standard deviation time two flows                                                                | Number - Decimal     | 0.0~ 84310682.0443178                                                                                                                                                                                                                                     | Packets flow inter arrival time standard deviation                                                                                                                                                                                                                                                                                                                                  |
| Flow IAT Max      | Maximum time between two flows                                                                   | Number               | 0~ 119991524                                                                                                                                                                                                                                              | Packets flow inter arrival time mAx                                                                                                                                                                                                                                                                                                                                                 |
| Flow IAT Min      | Minimum time between two flows                                                                   | Number               | 0~ 119991524                                                                                                                                                                                                                                              | Packets flow inter arrival time Min                                                                                                                                                                                                                                                                                                                                                 |
| Fwd IAT Tot       | Total time between two packets sent in the forward direction                                     | Number               | 0~ 119999899                                                                                                                                                                                                                                              | Foward inter arrival time, the time between two packets sent foward direction mean                                                                                                                                                                                                                                                                                                  |
| Fwd IAT Mean      | Mean time between two packets sent in the forward direction                                      | Number               | 0.0~ 119991524.0                                                                                                                                                                                                                                          | Foward inter arrival time, the time between two packets sent foward direction mean                                                                                                                                                                                                                                                                                                  |
| Fwd IAT Std       | Standard deviation time between two packets sent in the forward direction                        | Number - Decimal     | 0.0~ 84389349.7950451                                                                                                                                                                                                                                     | Foward inter arrival time, the time between two packets sent foward direction standard deviation                                                                                                                                                                                                                                                                                    |
| Fwd IAT Max       | Maximum time between two packets sent in the forward direction                                   | Number               | 0~ 119991524                                                                                                                                                                                                                                              | Foward inter arrival time, the time between two packets sent foward direction Max time                                                                                                                                                                                                                                                                                              |
| Fwd IAT Min       | Minimum time between two packets sent in the forward direction                                   | Number               | 0~ 119991524                                                                                                                                                                                                                                              | Foward inter arrival time, the time between two packets sent foward direction toptal                                                                                                                                                                                                                                                                                                |
| Bwd IAT Tot       | Total time between two packets sent in the backward direction                                    | Number               | 0~ 119999812                                                                                                                                                                                                                                              | Backwardinter arrival time, the time between two packets sent forward direction total                                                                                                                                                                                                                                                                                               |
| Bwd IAT Mean      | Mean time between two packets sent in the backward direction                                     | Number               | 0.0~ 119913081.0                                                                                                                                                                                                                                          | Backward inter arrival time, the time between two packets sent backward Mean                                                                                                                                                                                                                                                                                                        |
| Bwd IAT Std       | Standard deviation time between two packets sent in the backward direction                       | Number - Decimal     | 0.0~ 84502515.871413                                                                                                                                                                                                                                      | Backward inter arrival time, the time between two packets sent backward Standard deviation                                                                                                                                                                                                                                                                                          |
| Bwd IAT Max       | Maximum time between two packets sent in the backward direction                                  | Number               | 0~ 119913081                                                                                                                                                                                                                                              | Backward inter arrival time, the time between two packets sent backward Max                                                                                                                                                                                                                                                                                                         |
| Bwd IAT Min       | Minimum time between two packets sent in the backward direction                                  | Number               | 0~ 119913081                                                                                                                                                                                                                                              | Backward inter arrival time, the time between two packets sent backward Min                                                                                                                                                                                                                                                                                                         |
| Fwd PSH Flags     | Number of times the PSH flag was set in packets travelling in the forward direction (0 for UDP)  | Binary               | {0, 1}                                                                                                                                                                                                                                                    | There are 6 TCP control flags 4 of them are `<br/>`SYN - Initiates a connection `<br/>`ACK - Acknowledges received data `<br/>`FIN - Closes a connection `<br/>`RST - Aborts a connection in response to an error `<br/>`                                                                                                                                                                                              |
| Bwd PSH Flags     | Number of times the PSH flag was set in packets travelling in the backward direction (0 for UDP) | Binary               | {0, 1}                                                                                                                                                                                                                                                    | PSH - informs the receiver that the sender has no further data to transmit (for now)                                                                                                                                                                                                                                                                                                |
| Fwd URG Flags     | Number of times the URG flag was set in packets travelling in the forward direction (0 for UDP)  | Binary               | {0, 1}                                                                                                                                                                                                                                                    | URG - to inform a receiving station that certain data within a segment is urgent and should be prioritized                                                                                                                                                                                                                                                                          |
| Bwd URG Flags     | Number of times the URG flag was set in packets travelling in the backward direction (0 for UDP) | Binary               | {0, 1}                                                                                                                                                                                                                                                    | URG - to inform a receiving station that certain data within a segment is urgent and should be prioritized                                                                                                                                                                                                                                                                          |
| Fwd Header Len    | Total bytes used for headers in the forward direction                                            | Number               | 0~ 204920                                                                                                                                                                                                                                                 | Bytes for headers                                                                                                                                                                                                                                                                                                                                                                   |
| Bwd Header Len    | Total bytes used for headers in the forward direction                                            | Number               | 0~ 383632                                                                                                                                                                                                                                                 | Bytes for headers                                                                                                                                                                                                                                                                                                                                                                   |
| Fwd Pkts/s        | Number of forward packets per second                                                             | Number               | 0.0~ 4000000.0                                                                                                                                                                                                                                            | Forwarding rate refers to the number of network packets that can be processed by the netowrk equipment                                                                                                                                                                                                                                                                              |
| Bwd Pkts/s        | Number of backward packets per second                                                            | Number               | 0.0~ 2000000.0                                                                                                                                                                                                                                            | Forwarding rate refers to the number of network packets that can be processed by the netowrk equipment                                                                                                                                                                                                                                                                              |
| Pkt Len Min       | Minimum length of a flow                                                                         | Number               | 0~ 1460                                                                                                                                                                                                                                                   | packet length                                                                                                                                                                                                                                                                                                                                                                       |
| Pkt Len Max       | Maximum length of a flow                                                                         | Number               | 0~ 64440                                                                                                                                                                                                                                                  | packet length                                                                                                                                                                                                                                                                                                                                                                       |
| Pkt Len Mean      | Mean length of a flow                                                                            | Number - Decimal     | 0.0~ 3326.9937254902                                                                                                                                                                                                                                      | packet length                                                                                                                                                                                                                                                                                                                                                                       |
| Pkt Len Std       | Standard deviation length of a flow                                                              | Number - Decimal     | 0.0~ 10579.8091239129                                                                                                                                                                                                                                     | packet length                                                                                                                                                                                                                                                                                                                                                                       |
| Pkt Len IAT       | Minimum inter-arrival time of packet                                                             | Number - Decimal     | 0.0~ 111932361.098431                                                                                                                                                                                                                                     | packet length                                                                                                                                                                                                                                                                                                                                                                       |
| FIN Flag Cnt      | Number of packets with FIN                                                                       | Binary               | {0, 1}                                                                                                                                                                                                                                                    | Indiciates the connection is being torn down. Both sender and receiver send the FIN packets to gracefully terminate the connection                                                                                                                                                                                                                                                  |
| SYN Flag Cnt      | Number of packets with SYN                                                                       | Binary               | {0, 1}                                                                                                                                                                                                                                                    | Packets that are used to intiate a connection                                                                                                                                                                                                                                                                                                                                       |
| RST Flag Cnt      | Number of packets with RST                                                                       | Binary               | {0, 1}                                                                                                                                                                                                                                                    | Signify the connection is down or maybe the service is not accepting the reqeusts                                                                                                                                                                                                                                                                                                   |
| PSH Flag Cnt      | Number of packets with PUSH                                                                      | Binary               | {0, 1}                                                                                                                                                                                                                                                    | Packets that are used to confirm that the data packets have been received, also used to confirm the intitation request and tear down requests.                                                                                                                                                                                                                                      |
| ACK Flag Cnt      | Number of packets with ACK                                                                       | Binary               | {0, 1}                                                                                                                                                                                                                                                    | Indicate that the packet is carrying should be processed immediately by the TCP stack                                                                                                                                                                                                                                                                                               |
| URG Flag Cnt      | Number of packets with URG                                                                       | Binary               | {0, 1}                                                                                                                                                                                                                                                    | Indicate that the data that the packet is carrying should be processed immediately by the TCP stack.                                                                                                                                                                                                                                                                                |
| CWR Flag Count    | Number of packets with CWR                                                                       | Binary               | {0, 1}                                                                                                                                                                                                                                                    | Indicates that the sending host has received TCP segment with the ECE flag set. The congestion window is an internal variable maintened by TCP to manage the size of the send window.                                                                                                                                                                                               |
| ECE Flag Cnt      | Number of packets with ECE                                                                       | Binary               | {0, 1}                                                                                                                                                                                                                                                    | Indicates that a TCP Peer is ECN capable during the TCP 3-way handsahke and to indicate TCP segment was receive don the connection with ECN field in the IP header set to 11                                                                                                                                                                                                        |
| Down/Up Ratio     | Download and upload ratio                                                                        | Number               | 0~ 126                                                                                                                                                                                                                                                    | ping?                                                                                                                                                                                                                                                                                                                                                                               |
| Pkt Size Avg      | Average size of packet                                                                           | Number - Decimal     | 0.0~ 3328.2989407611                                                                                                                                                                                                                                      | average packet size                                                                                                                                                                                                                                                                                                                                                                 |
| Fwd Seg Size Avg  | Average size observed in the forward direction                                                   | Number - Decimal     | 0.0~ 16529.3138401559                                                                                                                                                                                                                                     | segment size                                                                                                                                                                                                                                                                                                                                                                        |
| Bwd Seg Size Avg  | Average size observed in the backward direction                                                  | Number - Decimal     | 0.0~ 30375.08333333333                                                                                                                                                                                                                                    | segment size                                                                                                                                                                                                                                                                                                                                                                        |
| Fwd Byts/b Avg    | Average number of bytes bulk rate in the forward direction                                       | Number               | 0.0 ~ 0                                                                                                                                                                                                                                                   | N/A                                                                                                                                                                                                                                                                                                                                                                                 |
| Fwd Pkts/b Avg    | Average number of packets bulk rate in the forward direction                                     | N/A                  | 0                                                                                                                                                                                                                                                         | N/A                                                                                                                                                                                                                                                                                                                                                                                 |
| Fwd Blk Rate Avg  | Average number of bulk rate in the forward direction                                             | N/A                  | 0                                                                                                                                                                                                                                                         | N/A                                                                                                                                                                                                                                                                                                                                                                                 |
| Bwd Byts/b Avg    | Average number of bytes bulk rate in the backward direction                                      | N/A                  | 0                                                                                                                                                                                                                                                         | N/A                                                                                                                                                                                                                                                                                                                                                                                 |
| Bwd Pkts/b Avg    | Average number of packets bulk rate in the backward direction                                    | N/A                  | 0                                                                                                                                                                                                                                                         | N/A                                                                                                                                                                                                                                                                                                                                                                                 |
| Bwd Blk Rate Avg  | Average number of bulk rate in the backward direction                                            | N/A                  | 0                                                                                                                                                                                                                                                         | N/A                                                                                                                                                                                                                                                                                                                                                                                 |
| Subflow Fwd Pkts  | The average number of packets in a sub flow in the forward direction                             | Number               | 1~ 280043                                                                                                                                                                                                                                                 | Subflows are set up the same as regular TCP connections. They consist of a flow of TCP segments operating over individual paths but still part of the overall MPTCP connection. Subflows are never fixed and may fluctuate in number during the lifetime of the parent Multipath TCP connection                                                                                     |
| Subflow Fwd Byts  | The average number of bytes in a sub flow in the forward direction                               | Number               | 0~ 8961376                                                                                                                                                                                                                                                | MPTCP forward bytes in subflow                                                                                                                                                                                                                                                                                                                                                      |
| Subflow Bwd Pkts  | The average number of packets in a sub flow in the backward direction                            | Number               | 0~ 25806                                                                                                                                                                                                                                                  | Subflows are set up the same as regular TCP connections. They consist of a flow of TCP segments operating over individual paths but still part of the overall MPTCP connection. Subflows are never fixed and may fluctuate in number during the lifetime of the parent Multipath TCP connection                                                                                     |
| Subflow Bwd Byts  | The average number of bytes in a sub flow in the backward direction                              | Number               | 0~ 37583377                                                                                                                                                                                                                                               | MPTCP backward bytes in subflow                                                                                                                                                                                                                                                                                                                                                     |
| Init Fwd Win Byts | Number of bytes sent in initial window in the forward direction                                  | Number               | -1~ 65535                                                                                                                                                                                                                                                 | Number of bytes sent in initial window in the forward direction                                                                                                                                                                                                                                                                                                                     |
| Init Bwd Win Byts | # of bytes sent in initial window in the backward direction                                      | Number               | -1~ 65535                                                                                                                                                                                                                                                 | backward direction number of inital bytes                                                                                                                                                                                                                                                                                                                                           |
| Fwd Act Data Pkts | # of packets with at least 1 byte of TCP data payload in the forward direction                   | Number               | 0~ 1468                                                                                                                                                                                                                                                   | # of packets with at least 1 byte of TCP data payload in the forward direction                                                                                                                                                                                                                                                                                                      |
| Fwd Seg Size Min  | Minimum segment size observed in the forward direction                                           | Number               | 0~ 56                                                                                                                                                                                                                                                     | Minimum segment sizes                                                                                                                                                                                                                                                                                                                                                               |
| Active Mean       | Mean time a flow was active before becoming idle                                                 | Number - Decimal     | 0.0~ 111992358.0                                                                                                                                                                                                                                          | Basically, a flow is a sequence of data packets that belong together (that is one data transfer, for example, one file) and that are sent between two devices in a network. With the active flow timeout setting, your device divides this flow into small pieces so that not all information of the flow needs to be sent at the end of data delivery.                             |
| Active Std        | Standard deviation time a flow was active before becoming idle                                   | Number - Decimal     | 0.0~ 60177110.6318582                                                                                                                                                                                                                                     | Active time where packets are being moved                                                                                                                                                                                                                                                                                                                                           |
| Active Max        | Maximum time a flow was active before becoming idle                                              | Number               | 0~ 111992358                                                                                                                                                                                                                                              | Active time where packets are being moved                                                                                                                                                                                                                                                                                                                                           |
| Active Min        | Minimum time a flow was active before becoming idle                                              | Number               | 0~ 111992358                                                                                                                                                                                                                                              | Active time where packets are being moved                                                                                                                                                                                                                                                                                                                                           |
| Idle Mean         | Mean time a flow was idle before becoming active                                                 | Number - Decimal     | 0.0~ 119991524.0                                                                                                                                                                                                                                          | The idle timeout is the number of seconds after which a flow entry is removed from the flow table and the hardware provided because no packets match it. The hard timeout is the number of seconds after which the flow entry is removed from the flow table and the hardware whether or not packets match it                                                                       |
| Idle Std          | Standard deviation time a flow was idle before becoming active                                   | Number - Decimal     | 0.0~ 72512847.2307394                                                                                                                                                                                                                                     | Idle time of the flow (caused by various reasons)                                                                                                                                                                                                                                                                                                                                   |
| Idle Max          | Maximum time a flow was idle before becoming active                                              | Number               | 0~ 119991524                                                                                                                                                                                                                                              | Idle time of the flow (caused by various reasons)                                                                                                                                                                                                                                                                                                                                   |
| Idle Min          | Minimum time a flow was idle before becoming active                                              | Number               | 0~ 119991524                                                                                                                                                                                                                                              | Idle time of the flow (caused by various reasons)                                                                                                                                                                                                                                                                                                                                   |

## Model Development

* Used four models
  * Logistic Regression
  * Random Forest
  * Support Vector Machines
  * Neural Network (Multi-Layer Perceptron)
* Results
  * Logistic Regression
    * Results
  * Random Forest
    * Results
  * Support Vector Machines
    * Results
  * Neural Network
  * Results
* Achieved around ~99% accuracy on models, which matched studies out in real world

## Advesarial Machine Learning Implementation

* Advesarial machine learning is where you take the input data and slightly tweak it to test the robustness of the model
* Impleneted by adjusting all the attack data
* Dataset Adjustments
  * Pulled out all attack data
  * Determined that only 11 of the 31 features could be changed
    * Researched which features could be adjusted
  * Randomly adjusted 3 of the 11 features on each row
  * Each feature was adjusted by a random percent between 1 and 5 (inclusive)
    * Also changed features that were related to the original feature
    * Determined which features were interconnected to the feature and also changee those from a random percent between 1 and 5 (inclusive)
    * Determined the interconnections through research and heatmap analysis
  * Repeated the last two steps five times for each row
  * Turned 2.7 million attack rows into 13.75 million augemented attack rows
* Results

## References

All consulted papers & documentation is available in the "papers" folder.
